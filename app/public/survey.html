<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<title>Friend Finder</title>

<!-- Bootstrap CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"/>

<style>
    h4 {
        font-weight: bold;
    }
    label {
        font-weight: normal;
    }
    .questions {
        margin-bottom: 30px;
    }
    .submit {
        margin-top: 30px;
    }
    .links {
        margin-bottom: 30px;
    }
    #match-photo {
        width: 200px;
        margin-bottom: 10px;
    }
    #match-message {
        font-size: 16px;
    }
</style>

</head>
<body>

    <div class="container">

        <h2>Questionnaire</h2>
        <hr />
        <form>
            <!-- ABOUT YOU -->
            <!-- ========================================================================================= -->
            <h4>About You</h4>

            <div class="form-group">
                <label for="name"><span class="text-danger">*</span>Name</label>
                <input type="text" id="name" class="form-control"/>
            </div>

            <div class="form-group">
                <label for="photo"><span class="text-danger">*</span>Link to Photo Image</label>
                <input type="text" id="photo" class="form-control" />
            </div>

            <p class="text-danger">*Required field</p>

            <hr />

            <!-- QUESTIONS -->
            <!-- ========================================================================================= -->
            <div class="questions">
                <h4>Question 1</h4>
                <p>Your mind is always buzzing with unexplored ideas and plans.</p>
                <select id="q1" class="form-control">
                    <option value="default">Select an option</option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>

            <div class="questions">
                <h4>Question 2</h4>
                <p>Generally speaking, you rely more on your experience than your imagination.</p>
                <select id="q2" class="form-control">
                    <option value="default">Select an option</option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>

            <div class="questions">
                <h4>Question 3</h4>
                <p>You find it easy to stay relaxed and focused even when there is some pressure.</p>
                <select id="q3" class="form-control">
                    <option value="default">Select an option</option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>

            <div class="questions">
                <h4>Question 4</h4>
                <p>You rarely do something just out of sheer curiosity.</p>
                <select id="q4" class="form-control">
                    <option value="default">Select an option</option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>

            <div class="questions">
                <h4>Question 5</h4>
                <p>People can rarely upset you.</p>
                <select id="q5" class="form-control">
                    <option value="default">Select an option</option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>

            <div class="questions">
                <h4>Question 6</h4>
                <p>It is often difficult for you to relate to other people’s feelings.</p>
                <select id="q6" class="form-control">
                    <option value="default">Select an option</option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>

            <div class="questions">
                <h4>Question 7</h4>
                <p>In a discussion, truth should be more important than people’s sensitivities.</p>
                <select id="q7" class="form-control">
                    <option value="default">Select an option</option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>

            <div class="questions">
                <h4>Question 8</h4>
                <p>You rarely get carried away by fantasies and ideas.</p>
                <select id="q8" class="form-control">
                    <option value="default">Select an option</option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>

            <div class="questions">
                <h4>Question 9</h4>
                <p>You think that everyone’s views should be respected regardless of whether they are supported by facts or not.</p>
                <select id="q9" class="form-control">
                    <option value="default">Select an option</option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>

            <div class="questions0">
                <h4>Question 10</h4>
                <p>You feel more energetic after spending time with a group of people.</p>
                <select id="q10" class="form-control">
                    <option value="default">Select an option</option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>

            <button type="submit" class="btn btn-info btn-lg submit" data-toggle="modal"><span class="glyphicon glyphicon-ok-sign"></span> Submit</button>
        </form>

        <hr />

        <!-- FOOTER LINKS -->
        <!-- ========================================================================================= -->
        <div class="links">
            <a href="/">Home Page</a> |
            <a href="/api/friends">API Friends List</a> |
            <a href="https://github.com/chzwzrd/FriendFinder/">GitHub Repo</a>
        </div>
    </div> <!-- /.container -->
    
    <!-- MODALS -->
    <!-- ========================================================================================= -->
    <!-- Form Validation Modal -->
    <div class="modal fade" id="validator" tabindex="-1" role="dialog" aria-labelledby="validatorLabel">
        <div class="modal-dialog modal-sm" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                    <h4 class="modal-title" id="validatorLabel"></h4>
                </div>
                <div class="modal-body">
                     <h4>Oops, make sure to fill out all fields!</h4>
                </div>
            </div>
        </div>
    </div>

    <!-- Match Found Modal -->
    <div class="modal fade" id="matchFound" tabindex="-1" role="dialog" aria-labelledby="matchFoundLabel">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                    <h4 class="modal-title" id="matchFoundLabel"></h4>
                </div>
                <div class="modal-body" id="matchFoundModalBody">
                    <img id="match-photo" src="#" alt="match photo" />
                    <p id="match-message"></p>
                </div>
            </div>
        </div>
    </div>

    <!-- JAVASCRIPT -->
    <!-- ========================================================================================= -->
    <!-- jQuery CDN -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>

    <!-- Bootstrap JavaScript (always goes beneath jQuery CDN) -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

    <!-- Axios CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.17.1/axios.min.js"></script>

    <!-- JavaScript -->
    <script>
        
        $(window).on('load', (e) => {

            $('.submit').on('click', (e) => {

                e.preventDefault();

                // FORM VALIDATION
                // =====================================================================================
                if ($('#name').val() === '' ||
                    $('#photo').val() === '' ||
                    $('#q1').val() === 'default' ||
                    $('#q2').val() === 'default' ||
                    $('#q3').val() === 'default' ||
                    $('#q4').val() === 'default' ||
                    $('#q5').val() === 'default' ||
                    $('#q6').val() === 'default' ||
                    $('#q7').val() === 'default' ||
                    $('#q8').val() === 'default' ||
                    $('#q9').val() === 'default' ||
                    $('#q10').val() === 'default') {
                        $('#validator').modal('toggle');

                // HTTP POST REQUEST
                // =====================================================================================
                } else {

                    // create object that will be sent as json in post request
                    var answers = {
                        name: $('#name').val().trim(),
                        photo: $('#photo').val().trim(),
                        scores: [
                            $('#q1').val(),
                            $('#q2').val(),
                            $('#q3').val(),
                            $('#q4').val(),
                            $('#q5').val(),
                            $('#q6').val(),
                            $('#q7').val(),
                            $('#q8').val(),
                            $('#q9').val(),
                            $('#q10').val()
                        ]
                    };

                    axios.post('/api/friends', answers)
                        .then((res) => {
                            console.log(res.data);

                            var percentCompatible = (40 - res.data[2]) / 40 * 100;

                            $('.modal-title').text(`Your soul buddy is...${res.data[0]}!`);
                            $('#match-photo').attr('src', res.data[1]);
                            $('#match-message').text(`Congrats! You and ${res.data[0]} are ${percentCompatible}% compatible!`);

                            $('#matchFound').modal('toggle');
                        })
                        .catch((err) => {
                            console.error(err);
                        });
                    
                    // clear out form
                    $('#name').val('');
                    $('#photo').val('');
                    $('#q1').val('default');
                    $('#q2').val('default');
                    $('#q3').val('default');
                    $('#q4').val('default');
                    $('#q5').val('default');
                    $('#q6').val('default');
                    $('#q7').val('default');
                    $('#q8').val('default');
                    $('#q9').val('default');
                    $('#q10').val('default');
                }

            });
        });
        
    </script>
</body>
</html>